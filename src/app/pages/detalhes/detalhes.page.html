<div *ngIf="pokemon">
  <ion-header [translucent]="true" id="detalhes-header-id">
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-button (click)="voltar()">
          <ion-icon slot="icon-only" name="arrow-back-outline" />
        </ion-button>
      </ion-buttons>
      <ion-title>
        <ion-text color="medium" style="font-size: 0.8em">
          #{{ pokemon.id }}
        </ion-text>
        <ion-text class="ion-text-capitalize"> {{ pokemon.name }} </ion-text>
      </ion-title>
      <ion-buttons slot="end">
        <ion-button id="open-toast" (click)="toggleFavorito()">
          <ion-icon
            slot="icon-only"
            [name]="isFavorito ? 'heart' : 'heart-outline'"
            [color]="isFavorito ? 'danger' : ''"
          />
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
  </ion-header>

  <ion-content [fullscreen]="true">
    <ion-header collapse="condense">
      <ion-toolbar>
        <ion-title size="large">
          <ion-text color="medium" style="font-size: 0.8em">
            #{{ pokemon.id }}
          </ion-text>
          <ion-text class="ion-text-capitalize"> {{ pokemon.name }} </ion-text>
        </ion-title>
      </ion-toolbar>
    </ion-header>

    <ion-grid>
      <ion-row class="ion-justify-content-center">
        <ion-col
          size="12"
          size-md="8"
          size-lg="6"
          style="display: flex; align-items: center"
        >
          <ion-button
            fill="clear"
            shape="round"
            [routerLink]="['/detalhes', pokemon.id - 1]"
            [disabled]="pokemon.id === 1"
            color="medium"
          >
            <ion-icon slot="icon-only" name="chevron-back" />
          </ion-button>
          <ion-img
            [src]="'https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/home/' + pokemon.id + '.png'"
            [alt]="pokemon.name"
            class="img-detalhes"
          />
          <ion-button
            fill="clear"
            shape="round"
            [routerLink]="['/detalhes', pokemon.id + 1]"
            [disabled]="pokemon.id === MAX_ID"
            color="medium"
          >
            <ion-icon slot="icon-only" name="chevron-forward" />
          </ion-button>
        </ion-col>
      </ion-row>

      <ion-row class="ion-justify-content-center">
        <ion-col size="12" size-md="8" size-lg="6" class="ion-padding">
          <div
            class="ion-justify-content-between ion-align-items-end"
            style="display: flex"
          >
            <ion-text>
              <h5 class="ion-no-margin" style="font-weight: bold">Altura</h5>
              <p class="ion-no-margin">{{ pokemon.height / 10 }}m</p>
            </ion-text>

            <div style="display: flex; gap: 8px">
              <ion-badge
                *ngFor="let data of pokemon.types"
                class="ion-text-capitalize badge"
                style="font-size: 1rem; padding: 8px 12px"
                [ngStyle]="getBadgeStyle(data.type.name)"
              >
                {{ data.type.name }}
              </ion-badge>
            </div>

            <ion-text class="ion-text-right">
              <h5 class="ion-no-margin" style="font-weight: bold">Peso</h5>
              <p class="ion-no-margin">{{ pokemon.weight / 10 }}kg</p>
            </ion-text>
          </div>
        </ion-col>
      </ion-row>

      <ion-row class="ion-justify-content-center">
        <ion-col size="12" size-md="8" size-lg="6">
          <ion-card>
            <ion-card-header>
              <ion-card-title style="font-weight: bold">
                Habilidades
              </ion-card-title>
            </ion-card-header>

            <ion-card-content class="ion-no-padding">
              <ion-list>
                <ion-item
                  *ngFor="let data of pokemon.abilities; let isLast = last"
                  [lines]="isLast ? 'none' : 'full'"
                >
                  <ion-label class="ion-text-capitalize">
                    {{ data.ability.name }}
                  </ion-label>
                </ion-item>
              </ion-list>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>

      <ion-row class="ion-justify-content-center">
        <ion-col size="12" size-md="8" size-lg="6">
          <ion-card>
            <ion-card-header>
              <ion-card-title style="font-weight: bold">
                Estat√≠sticas
              </ion-card-title>
            </ion-card-header>

            <ion-card-content class="ion-no-padding">
              <ion-list lines="none">
                <ion-item *ngFor="let data of pokemon.stats">
                  <ion-label
                    class="ion-text-capitalize"
                    style="text-wrap: nowrap"
                  >
                    {{ data.stat.name }}
                  </ion-label>

                  <div
                    style="
                      display: flex;
                      align-items: center;
                      gap: 8px;
                      width: 50%;
                    "
                  >
                    <ion-progress-bar
                      [value]="data.base_stat / 120"
                      [ngStyle]="getProgressBarStyle(pokemon.types[0].type.name)"
                      class="progress-bar"
                    />
                    <ion-text
                      class="ion-text-right"
                      style="font-weight: bold; min-width: 3ch"
                    >
                      {{ data.base_stat }}
                    </ion-text>
                  </div>
                </ion-item>
              </ion-list>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>
    <ion-toast
      [message]="toastMessage"
      duration="2000"
      position="top"
      positionAnchor="detalhes-header-id"
      [isOpen]="isToastOpen"
      (didDismiss)="setOpenToast(false)"
    />
  </ion-content>
</div>

<div
  *ngIf="!pokemon"
  style="
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
  "
>
  <ion-spinner name="circles" />
</div>
